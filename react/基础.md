# React - 基础

## 1. JSX

* 大括号内放置任何有效的 JavaScript 表达式
* 使用小驼峰为 html 属性命名
* jsx 也是一个表达式，可以作为属性值，函数返回值，参数
* jsx 元素必须有一个父元素

## 2. 组件 & 传参

组件，从概念上类似于 JavaScript 函数。它接受任意的入参（即 “props”），并返回用于描述页面展示内容的 React 元素。

**函数组件**

```jsx
const Welcome = function(props) {
  return <div>welcome react learning, { props.local }'s friend</div>
}
```

**class 组件**

```jsx
import React from 'react';
class Welcome extends React.Component {
  render() {
    return <div>welcome react learning, {this.props.local}'s friend</div>
  }
}
```

## 3. State & 生命周期

```jsx
class Welcome extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      time: new Date().toLocaleTimeString()
    }
    // 虽然这样干也可以使用定时器实现数据刷新，但此时组件还未被挂载，还是要使用生命周期钩子
    // this.init()
  }
  init(){
    this.timerId = setInterval(() => {
      this.setState({
        time: new Date().toLocaleTimeString()
      }) 
    })
  }
  componentDidMount() {
    this.timerId = setInterval(() => {
      this.setState({
        time: new Date().toLocaleTimeString()
      }) 
    })
  }
  render() {
    return (
      <div>
        <div>welcome react learning, {this.props.local}'s friend</div>
        <div>It's {this.state.time} now</div>
      </div>
    )
  }
}
```

### 3.1 关于setState

* 不要直接修改 state 的属性，直接修改并不会重新渲染组件。调用 setState({}) 才会重新渲染组件

  ```
  this.setState() // 不传入参数并不会执行 render
  this.setState({}) // 就算传入一个空的对象，也会修改 render
  ```

  >  构造函数是唯一可以给 `this.state` 赋值的地方

* State 的更新可能是异步的

  ```jsx
    constructor(props) {
      super(props);
      this.state = {
        counter: 0
      }
    }
    componentDidMount() {
      this.setState((state, props)=>({
        counter: state.counter + 1
      }))
      console.log(this.state.counter);  // 0
      this.setState((state, props)=>{
        console.log(state.counter); // 1
        return {
          counter: state.counter + 1
        }
      })
    }
  ```

* State 的更新会被合并

  浅合并

## 4. 事件

this 绑定问题

```jsx
 // bind 绑定
 <button onClick={this.increment.bind(this, item.id)}>增加</button>
 
 //  class fields
  increment = () => {
    this.setState({
      counter: this.state.counter ++
    })
  }
  
 // 箭头函数
  <button onClick={ (e) => this.increment(e)}>增加</button>
```



## 5. 条件渲染 & 列表渲染

jsx 可以作为属性值，存在变量、属性中

条件渲染可以用 if 语句、三元表达式、isSuccess && element 等方式

列表渲染可以将各个 jsx 放到一个数组中进行渲染



## 6. 表单

v-model 实现原理

```jsx
  constructor(){
    super()
    this.state = {
      value: null
    }
  }

  handleChange(e){
    this.setState({
      value: e.target.value
    })
  }

  render(){
    return (
      <div>
        <input type='text' value={this.state.value} onChange={ this.handleChange.bind(this) }/>
      </div>
    )
  }
```



## 7. 状态提升

